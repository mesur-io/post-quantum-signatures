const jwk = require('./jwk')
const jws = require('./jws')
const message = `Itâ€™s a dangerous business, Frodo, going out your door.`;
const msg = new TextEncoder().encode(message);

// (async ()=>{
//   console.log('sign and verify raw')
//   const {  publicKey,  privateKey } = await jwk.generate()
//   const sig1 = await jws.signRaw(msg, privateKey)
//   const ver1 = await jws.verifyRaw(sig1, publicKey)
//   const decoded = new TextDecoder().decode(ver1)
//   console.log(decoded === message)
// })()

// (async ()=>{
//   console.log('key conversions')
//   const { publicKey,  privateKey} = await jwk.generate()
//   const exported1 = jwk.exportPublicKeyJwk({ publicKey })
//   const imported1 = jwk.importJwk(exported1)
//   const exported2 = jwk.exportPublicKeyJwk({ publicKey: imported1 })
//   console.log(JSON.stringify(exported1) === JSON.stringify(exported2))

//   const exported3 = jwk.exportPrivateKeyJwk({ publicKey, privateKey })
//   const imported2 = jwk.importJwk(exported3)
//   const exported5 = jwk.exportPrivateKeyJwk({ publicKey: imported1, privateKey: imported2  })
//   console.log(JSON.stringify(exported3) === JSON.stringify(exported5))
// })()

// (async ()=>{
//   console.log('dilithium-crystals...')
//   const { publicKey,  privateKey} = await jwk.generate()
//   const { publicKeyJwk, privateKeyJwk } = await jwk.exportKeyPairJwk({ publicKey,  privateKey})
//   const jws1 = await jws.sign({
//     header: { 'kid': '123'},
//     payload: {
//       message
//     },
//     privateKeyJwk,
//   })
//   const { protectedHeader, payload } = await jws.verify({
//     jws: jws1,
//     publicKeyJwk
//   })
//   // console.log({protectedHeader, payload})
//   console.log(protectedHeader.alg === publicKeyJwk.alg)
//   console.log(payload.toString() === JSON.stringify({message}))
// })()

const dilithium = require('dilithium-crystals');

const fromHexString = (hexString) =>
    Uint8Array.from(hexString.match(/.{1,2}/g).map((byte) => parseInt(byte, 16)));

const toHexString = (bytes) =>
    bytes.reduce((str, byte) => str + byte.toString(16).padStart(2, '0'), '')

;(async () => {
    console.log('tests....');
    // const {publicKey, privateKey} = await dilithium.keyPair();
    // const message = new TextEncoder().encode('hello');
    // // const messageHex = toHexString(message);
    const messageHex = '68656c6c6f';

    //
    // const signature = await dilithium.sign(
    //     fromHexString(messageHex),
    //     fromHexString(toHexString(privateKey)),
    // );
    // const sigHex = toHexString(signature);
    // const pubKeyHex = toHexString(publicKey);
    const sigHex = 'F5C26686B4976C8842BED4F45B507AE27503E3E86D45BF62A035A912BE3B78CA136C5A46CA0260B227A813EE7F9EBD2F7CD6D726247FD6AF57C464F851CF3860D3466C37FB5BCC6FEB29429472B32FFE553A3718007C02D2B261665B19B4283880E874C4658586D67E27175AF01083807ED55E600D10E9727852447CE680BC736A0BEEC27A4B29B4B668122FB5D965182488DF29A400912ED87CF0B105A9AE4BAD5DD1B10082CD4A80C9EAB94CE698E2DBC612DC733BB40828F34BD2FC3A48CA5405BCDFCB82E77138A3D2200D71EA8D001385F89EDD9AC1117F2B1E8DA849B2F4D014A0683BE59EB6DE05505C025BBBA48F926A5A5D2140A44D3239F6A718DABCB1F343469802CBA936DCA46FE7FA9CB89D96A2C94EC3F8780A05874F124B4E60448F1F2053B7C6E20FCBF3AAAA6CB800952DD0E9EAE952DA413813F5D02CFAC9FB96B9D5B20EF09DB3A093FBFBB8E34B9D590AED3EE37C7325A0F069A0A8D700C0682E9CCB61F824E7AF1740B5DBC80554FDC3CCC410E0EBB8558ACF1C2AEF91C870B10AB30CAA83846F31474FFE840F97A5E895144854B9AEB3B1B48D7167AE2AEDB667E7C058C39F8178991F0C771EDE1447C29B5C8810AA74987A40FF302103E13ACE90AFC0050C55B854E0A4E635294F68D8CE95D4C6C2F8F8EB76B558F2E6F72D71F9CFA8B7E99A6E4E6F427A38562671397FD8AEA29920DEA09D9D913F9EEE0C2774DFC27162752FC67265D7C0E9329F15A3D782BF42889B5D4500A1BF12B5D8B7BAA812BA270586D3A343A8B94481B09C087C89D718B9F1CB3FF5B5AECDA464E2E8CCB8A2BB4E6B816A22A86573BC081409CD22C32896C6179E2136B85A78EEC9CACEE75B8EFD911076CDCCA1BD7948F1AEB5BB27DEFD2F3331510343881BD8483DA7C10FF398E51E4EFF877A7286DA6015A6D568095CE77E6EA0D2D2F9FBE8F8CA0ECEC39ADACC1BE5F7BE19DA16D3AC91518435934662B3DBE577EFDBEC481164E4A17E55F30F9DE36CA9DC2BA7D3431618C7335734B28D3B3578D93A58A700F733CDF4EE1E14564B64DFB76CF2FB645490CDC297BC307455938D891EA78E7FCCB1B048C353BB15AE298C0830CD53886C01D4E50A39B101E67CB87CDB5B2BD869B5EF1E37781E78851862AED17C55DE84EE43D68D75D44CAD207627CD18D5B9D69A5FE0864FD515A4FF0BEBAB7D44B4DF1581CAE44C383842D099EEC1141FFCAFDD1465278FC67A5C55C28FC0AABF96D3F157FC230C4BCD3DED9C5BF2D9113812A59D945175E65BCEB1BCCAC892C6BEEC8133121F12585CA36E8F4E9D06EB7A73DDA1C0CAABB0EB08AEEC355A4B8E742BFA3F67329D99919DAC8DF81BBD3C9778927B959221B65D43C5D690870CAE65083009A104A84A2526E5FDC8ADDF6B7457C0D05600852B8954B33A80D21A5EF73961F246C162D6F13A813E62A4B55208665340F2B97A4B0C14735ACE246D720DD7B65324DAE5059567CA2E62CBCE988252365376808FD20969F49A4EBE9AABE1BA2D5976F2596F57359F105B0C145F2D0D81F983E8E00661BC09A7B159C606E3F6CC39F024919D4A4F650E1AD5F7BEEFD1DDA8F8197565EF32A083B698F429D25002AE909C270D589EB35D1FE14CAB35433C7A526055894BED27C41EC2067D1FAC50FAE5841B7A652A82A43DAEA2CE771D8BD992035C751B5933EBAE9467CC288FF6339B39685EEDAEE5441EEB616DAF0E93B550EA7BADF692C2387BFD27436170D9FD534A7E264DB590AF4DAA6C0BA2AC1176B3EF5677D9622D2C93B05948F286DFE41A6A83F6C8F5D3F9BC087D58D9B9D98D3BAE742F6EA909D028E450EF980F719541EF3787F92B00BBCAD225F0D2097D81D6C6AF1BF209E0BD1C9C083B436525CAF5671077EB722C49A2A21150AAC8ACECF7FDFCC39BD2DC15654D58CB8181200126CF9494C092D53105963B541337E2A73ECFCF9114792FEF324FDE2B89E33A23A4153BB2305651B83E01849EEFB64534A2088E0CF6B8034E5F42862791EC360EAEC9CC51B8DFE3F734BEC81A5A99B8684FBEA1FEA089763E7C4607844504B80E285A1479F8737FDA410BAAED15C3214D97568316C764B162EAF85D17FE0C3B8D1699FFE045657AB69FC21BB354AFE8546291B9F1838E579694ADBA5B8C4BBC9085A5B95F22BA5981FA7C48868E07F384A22EE46558C78D3AB9126CA6C0CB88BADABDC3B670F569727BE103CAC96245CEBFD8792A317435BD08EAB21E8B299284AFD8D9608D1DC15581DAB9C8AF249E51FE8C5A454D741457EA1F0A944E14CE2C1CD28F2B23C36FB19FFC8E213DB742AFB7697F4361D482BAABB793292E34AC75C5325658D2BF6318D177E6D78E5DD6388490D20B6B0C92AF2A52C0A00CC45BE5A18496DD8F4B181641702FD30966B6B899282E0FD2DCF5B32C0490A586DF3922030B5A163A7A8DC89AEEF182D12B5C64FF275D0BA4A0A19EDEDA2C8E5F879C05288E09FC60176DF31DF0DD13F4C40263ADD7045613AA27CB7F8ECF3E9B60410AE26E4DD7D08B05574AABC63F5C94A55921CEF2C02FA64BD9CC5AA1799B7297879C88504382BC4A5DE8BC8FC33DE9CC702713F867B1CC86D1ED2BD2A63360AED2BFEA99C12B54706C551A19C83184A5C93E69E5875F72EFB2B597DF3F0EDCDBB1598B56940D9E9E0E6D9F261B916794CE42C3EC17576C72F813062FA34343558B00277E028005313EF8E64A3B37EEE366C3D8FF9E1D8629CED05B566A5C2C02DEF90CE22EF14ACE4F0AF87AD7312D4ACE5CAC7C0714D65D6738AB347BD5B27318FD6CF3CD42926068902F0E2BEFC517582AD1E75DD3E284C92CE14442D289CF6761CBE0C42907740370B3DF7C5BC30606B663157C50C8EEA1BCD08E7C5449AE5CCC3C80F32CD02B60F83648791A1F2A5FF6B2FD6D5F8C17F9011324FE810DB748E52D3CA84D19FDCBE1A94D1A15088A894D1446BFD9C3A776FB61C16A7C0EB79022F8397D896C46B2F61440B68CF84FFB845F2F5C12CDB0676E02B1BD1EE3C44EF342F3EA91A89D26B76823993D54DB62A6EC44B36781CDD6C003077F202BCA56F9021067FA0ADED167B54FE3438AE8DA93CC3D6C5820F9548017375B304E6718E6CD21460B70D0CC174E660533445A5B7B352B586A4C67B7B1B307917280BE2E93F8686B91B8D80D8DD2AD3CDEFF86B77AC42A24892F2A7219C67408FE512D8E9925662458B4EBFD3554DE6F64B2A5AEBA72F738D19526E202BEC459FE2DEACF6BD1295FA2BB237F47BB1EAA4700F10C3A275A72A86B7D253D13308629DA9BF0C9DF251D873F9D9FAF9D3C8E097BC1A9260A95C47E2FD0BE62C38F6BDBDD03B0B28E2D914676AD92176B4AF69BAE01710A5FF34021D993FAB75D7CB6AB65CB2E2FD4FBF861AECA45A8ABA0DBC07F46C87724F0857492BA0A8D6A59BC6E0CD755B83D3E787790CD245EE5751908E3FB67D04B8272F765901D0A27D6480828C7D48075B6A2E977476324B10F2DFC6E124CD962F22C9CFCD6C053F84219580D7E7A33BB1315167D48D4FE155E19B059038946514D452018F5C5543F0BC14ED7FB950B480D69E1731CB778C2AA1FA38040C5E6E89D9339B0961DEF8A6A304F330BECCADB6E7C04080C136733960B9F925C4E51FABABE1669B1AFB237E33E20026D022BE2FFF96B560356FC4F22A9D5281FE142C858EDF17E7320080E6FCE5AC7C7D0E0783B62F2E99CB20967E8D48FB4C1ABA9F857F63F59760B19EBAB7EAE4C3EBACEF68EA67845AC1E92B9F9015E3AC10B26443C41A544DAE22C4639B6FBF0682A57AD162ECF8B98439F8E0B1EA05A92632C3EF99DAA41D3E3B83D1680640EF1EACBCC78B0B8FACD6C4DEFCEBF98CF5228C80E6B06AA8F376ADDDB6984176EECB59F8EB437889DC2742312970AE23CAF12670AF49A1366F39E516AC2EDA263681C8E29C9E0A3B1C1D8BA4A6DF440F1069F5A024B6DB4D688F2F47BE2156A06531552EC3D3F943018D1430B84EBBBE3CFF2C721368904C0D4C45C147185786DAF4A95FFABAD187C13EE9AEB55AAADD5E6E05E0C8CF1388C4B9BFC91AACD699081AB3E6DEB589CB2B8ACD7BE3ABA7D3C8F80EF0F9B174E8AE08138B491A3519F0CD61A4C3241FA29155E1B921297B4F0317849D0A73C2937337E79CCEAA0B1BE5E03F196F71929B564837817A3950B7F824D5C8A9D3320DC61707E46FFD33566F03F6C4CC22195B7CF27647174A28DC55D3A3CF3D92B9CB834648F386A840EC949EE303DBA494600930F21FEE24B4299D7DF40AF23479294ACD0F1829FA12EA124BB415759CADBA40409A4711F47B5F0DF23E75183DFFB5184A5AA88B1D771A30829CEEA45C58CAD069E56FBCB6422E5E6B79FF22A21B3D686006847849EF70B3F06447E058283961290B1083413053EF07E94E338BB02811975AE351F33D8DB43FC97843D7D70C89E5B4316E9DBDFBD38542E01915DC599A9111220C15DCB01D33F0F3312E59993BDF372AE494ED7A9DF3BC34C0CC97AE82D7575BA0C52AEB6430B7004717F60C5C3BB431B01E1366FB2770C5EFFF2E24D7611985CA945C52E686DD6620F304C1D87B3AAB3A2881D1476EBF68A354F8D78D250FB47B4D1BC58A01D47165A073FC9AA2072324C15BE4B96B8AA6D1AD2DA5AE77B02B75BD52D86F4385081BA8696938CAC7F96CACA86BE665D6184D1BDE5914113BD6E23EE6B74F1F63A545B62433E1C259AA22C7BFEEEF25693432F05C3388432946B5C2467941A1955DD4BACCD7B959F6C4FC2107EC9B3A0FE50B618AD38625748F850ABEB4BA3AF589AC280839723522DEC3E0B8EE188659D5B5CC9F2C8C5948BA5AAB6DCF3B6B5D4E4C11D28DEECDC26099CA1B695C5B1D0E46F3BCC85F981A8BEB43AF4D21EB6FF70D0080D6E6E9BC5455EA682C5E54FB16A459D0942872F47ECA4C737F179A2E7CBA336FD28ECFB5FA81E086DB9743B7E6C17BD83E100027666FF0B16C1553039DA15D57FAB624913B193F5EBFDA04D54A589F2497DB887F6C332C6BFB9C88A983D0EECCB43A4C8DF142ACEFE9CE22BBB41A02A88403769E297ABA315CBC18B4D9B716974FFFC2116F8D1158C0F9E3AC006A6873518E1DDD57C9CA8E9E54DFA778E11BA78D4C0F9F77482139A334E59C715933FAF3FC65C2999558944E738BA8787B3EEE5260D5471A57A775DC0E382FA58F3B380DADF0D2FE75329A616375D94CCDDC54D5F9830B373967CA345DE8FC6078F57EAB3D732040812369031BB66282F7650C42ED766542DCBA236B0814DFD5089240BEEE843D4C526739C93BCCADF11AF7EFD9AC6957BDA91D7692658D333008FB84BEAEFA306E09BE9DAA0734801140E65F5EA389E0E7E704B94D2C0290EAFEA4BD816FA49381F48DED38DB7C713CD096F6EFDD665BDD02CF6E2B47DA84A2B4C649E15C16B13D8D14DE3D818393055405C55D5B1106D2DED65A65E16E6B3ACD8C2993066ABDDE94BDCD53D4E88119C67B87E34212ABE3CBD7CFF751DABAFDF6ADC91EF2C53052192C565DD5C98042C5CE7F0F673855B92E5CF43CBE07465C5FDBEDEE563421DDA123860AD29EB552190DB3C9B73D976882C8475BDB6A283691CE4FDB1CD111BAC1070F9D879F31E97BA886ECF234E5C1ED5758D92BF32F94D687F21D1136272466159CDCD23B3304ECE41FE966664556F1E8AC8BCF230F0E1467050A8BCF6B27AB842E8678A1B02FC9130C44429D9876FCA5C9ACD6248DF798FE215B90EC3864D085F507BFA1D027D2E0607475AC8B90C00677D53A2A6F00C16A3754599C65326636F74BB3B0CC885AFFC616A7DCC9B2C352E37F1340D3B3336877AE907396FB4A3967A54C14EA396DCB2AD631A70DF9741DE4D50BE43444C5667340E62330A3D27DF0EBC98153EAFC158BD4990CA74E2A1AAFA9132E65536B83D4EA3FD370D745C18EBECA7C27F7824C93DC8F2A1A71BBDB47ADA37F58DD8DA53B9B15167AB96939720C95AEF8D3D9DB5100AE92AB611DC47B97E5AB42A480C0A53581E402D29BBA3CC9D82DDD7A75D9C0E2E7FFC0EFA900C3C8DD6E09E48307FF6058F24537C071DD83B5EA9EB3FFF318CFC07A7179FEE40DFF400A33719BDC58FA4298AA59ED23F1FAE531E5C8FD2FCF1CE161DAE25273C46B1509964B4930D0FD3F9CF5CEED74810029E5EE037803C9F8B879E0508B71E61D7BC60BBFF849775880E218CF2973704D868AAE7A13372B83B0121BE79C4201AA1E9BBE86C3366FE1AF5AD4A07B76C78EF9D357D9C2C042C307BB841CB7023E1903D96ECC14FE1930400E9079CE74C86427D76D77A33B9F277151E31CB451BCCE82543EFECEA80C041146E0A3DAE4AECC145A1191869AE0DE48F44E81546B5E55EAFF570724EE872EFAAFD754DC9E51CBCA50C8300744885C6BD970506152B81A6EDF102505B7CB8C7303F419BA1C0C3F76499B3D1203E548386A12E33484FB8D8FE063B536B707192E900000000000000000000000000000000000000000000000000000000080E0E161A20272F';
    const pubKeyHex = 'E0D40BBBA205498E53EE09FB6E273FC19C7D93C941B6414F1FC36E564ABE689D591516A6F89E4DB02E3698EC74EA7C134FEC4375FE6525314EAEB6DEBFB50939E7D62ACEAAEDE597773FF15317E00C78B8DE1EC62519FEB9BD7E133ED42EC7FA49B8142334978A4F94D3486D189F78F7B18A10E07F2D73676F0C0DDFAE5879D5AA9FEFF23EAD8FF229619B295B8113C52C0505E392DE5300BE4E2D30954CC222207520FAE0DF79811ED34BF3FA7DE3000648B225BD19A476A89F9879594DE5D408A859E66C73DD4B6C8A4AF64EB51F2EEB6D0E59D50287D7A26A06CC66BC33C1C6122BD766D960E3D3327DAEFCDC4B424084D28DE5D6E801129B3445100CAEAA44E54523247695CF6C2E82C70B073133BDDAAD7D114D26430D99D1C18A8D2EE13749A29DD21FCE1F95EBAD027F5D5F35CBE4D1BAFB5551302AC569513EA762B5F57B0289230BE9105C3FD9AD6860CBF82A2189BD0394EACF555430C639310BFB30352D128883FD66BA501974CB2132D422FF0679A40A35D054C81A96DF6ED47266AE3D7F0480E4B3C28EE1B2107E76CC2C502C3659C60AE11B581CF1655B8F483A8D059D6EFBC46D56D6F10EFE13FBD07B43EDCA80E410D7BFC0A7B0A564D406E546F03EB939BE1F4476892D81B3E0DCC8B7A3E8063F41DD04903E5A609569306E8819C04E66E5C76BF8C4F1AB02DDCA153959E10364E2A5AF89145E0C7454933BBF8BE3B856F639F66058CF04B00FB579C1123BDF9FF5B559B36539E65856C832D7D12CBD09389135A1B4480C2D962E98A0E857D84F82F45A62C86F567250FD6B18C156FBC1038353393A33712E1EA040D6F79486EE6147C414D17F585FE72ABBFDF838FBDD1B8027C14AB093EBD72AB8B3372AC7EF9D85C95D6110BDD49A00AF8E8DEB3049AA042B0B2D302518B6024D419D404732DA08D3569BD7199345E306FAD0D8DBA83A560966248740C294E21A4E72A91C3AAE082EC8EFCB5D45FC4C51DE3D4D352CED34E7E1222388A840B11D0F4571B5E6781B8B755341D3C7F0DA2BADB7EE9391E34552D1A38FB644C0697ACAB625330EFECBDA43186751F67966213B69785168D7577ABD34CCCACC930BF90C67083F8134419EB498DCBEFD2EE3190D05B3762D6F6B454C8FAA253F63C5AF22B4BBF707844858061AB1C1B0CA6E4DACBFC3BFFE5BA307F70934FC6608577AAA97DCA5A9D6C18C5BC345608D9EC77388A03F8DF69493B78934C21C93F7C3D53806CD74EC623E0D5F11E398E1A3E3BFCAD66182A7D95D7AEC01367F2A3E76CAFADB6A36364321C54FAE26BE2DEDD7B1CA9753E0DF0CF934892A92CBB7D24E2A6E4C064E3C1D77B1EB1B02E740CC5FF6C83F8B2B6C84E6B6E79C746070E8B1B2475D1A48FAA8580F910EF29643D246883F60D430F12719C81DD0E4E9D18419665FA46FBE0E4A1711948D66BA4A46637B33B3FB71235AAAE5CF767B9CB85E5344ABC5AC62DF2318E7F15022294690242F73E191C7DA62A0C5CF69B9EBAEA57DA6B0F7DCDF720A966462747DB1515B1EB7304735EA96DC3156C92EE81A6DA50317B21D84C07FCC5BB719B5E3525EBCAC72B16828F6D663C206B1AB58580D94DE2F13D4FAC7EF116F0DB40B139880AFCF75436ACB614F99E0F1DF9A81279BD0255C57DD7E4FFA2BA34A642D64907A4AFA1D1B844F34BF69DE087CB34121B3F80E64E00F751A06C1299DBB91C5AB084DF048740D5828DBF2971757FCB074F5621AD5BA6FF192487804DCA72D9514DA546E952B96AC0C870555509257E1E0536BEEA51729A6A87DD74059FA8485D58EC358FE896DCAC0EA1EE20B6CB5343BD3BCEB738CB4BF068230D74948EE9EE33A75AF41FDB0199044469962356ACAFABC6336324E5BA65211FDC1A580FCDE3CB632B638B2C03683555FD54C3556863912D49A64B4083F42720F273209FC4448B5597C759360068718F0DCAEF2BBC29F54BA6667640BF556E66D45C9C1846B3EA2FB3735F761E32A0392CCE691DB3577973B5B952A787CCB9C7EFE372B9A7324380F7C1D2BA34599100B1BE2836DDEC9651CD0627947B9878B6D3D96938D5E0C38616CF752736209DC92B6DA27EF376346B8FCB7A9781495822F1D892F39AFD85A1BA069B106A11D012B69C87F62A95AD524399F5E026F4F6F7A41F61E7CC94A6F7EAE0A5D0082B11D92D58E743DE4471A246BAD6289D3DFFBC90D7AD56E415F2C7B7CD07C18B5670A15198FF92DF2B2C0C929B17EE3DD0B08DA1316CA07AA9C19ECAC6218A05077450A9E27B143F1B0D8D337A28A909AE245ED9391031E9D1BB7887D9AC99302057D252A8E2E41FAAB34561BB3243998CBA5C8DB924B230D49C5217E5DEB1FE95E99BCC897EC23C8E294952B3F215DA044A631936293C0CAA25CAF24FC39F16363D4C5932ED752BA321CF0B6AAAB3990AAADC0DF8EC8265D61BFEDF37340B0B684BE57B8620179B6D33E89D33CDE01E12E27ADD345D0BC934B18771632B23BC75E6BF9C8F1D19B830A7E7BBA8AB1ED2BDDF8C4A2F7A1E906BAEF1771B42FE20488FD6E6197B8EE18FA7782E02F0FA2CA6DCCFC73C233E97C1905333C506B13026937AC24049E72158307DC5E8CE315B8ADA9AAEAE90A9560522F5E85B775EAE57D4A2C2ABA02DC76DCB9F6B6054C07D8F6FC09169CFB6827D585B0DDADE726091E66402C17848C46179C0C63E59BAD5868C49F90B298943B93504005C30A16E1E0AD1FA2D67DD3B7695E6E4C65806F2974C66E6B3E7B8ABCD5E0ABD81D5D51A2316EDECB8A81E4F08BE6780B8E38D5498DD6B0418EBC478135FA929A6874A7F88A613F68500798EE6CC97B6789E43D227478E5E15DA9F19537C02D551D4B756136BEE79EBAEEE704860FE8C6651E1408884AB2913A3F20F3DDE26104123355BD3846512C552C5E9705423F1E6A674E9AE43EB10BB7390D1D1B5BABDF79598EC69A834D16E91E03B309EDFA34A0EA4CD7176E1304ACD334DC834C42CCC49D373150BA833AD3DBD7132B22F56A93AD8A3B0BF108DB10682A95C75670200A2527A633AF871C5037F0118E4E9C058046AAD403C3F06E893A4711A7E6FA1FDA54A15DCCF0B1A92BDC75A050C71F3E54B88207DE3553674E244CC16B10722E0FEACEDEC6A4F242B898A56404236A773328B7FBE03F2EFE83EA14925B178F255A0B2FC6450749031E08BA00E7B348BB44DBCB806DD22CF65A36E2379EC8BB82A451A3CF9AADC5B586E3E113BE8B786CA43E18D8C94F2C8D017BD818AB29014BB6DD840F4E1BB88CAEF6EAABC7EDAC6AFDD7E99BFD5121FCA30B1D2D1AEFCA7D61219F614315955CFA493C87D132A5DC1A33F0D422CAA369F8CDE04ADCAF1720A3FD719CFF2CCF5F9545D38D040D071D38BF3911B0F9B7AFA9C97971B007875A20B1D0BD4025D1ED7F6042B2A280FF21E3A8D086487E317AEAA5CC5EE151D795A141B01C5D224E459BEA913B5D6FBCA1FF6899E34E5396FF6F55E0DFA2B666AF31C649B3F31A65C4D2154C1221B14CEC007B5BAE7572F8B33C665B6790970F3AF81B22B50368F8C33A3CF2AC1D1E0F4931498F2E818673D1D4D1C434A175557595CE552D55796990FA5F23E7637A4B2169DAEB8D82A67DA29F02275660E595691169745DA4B7804377789E184DA58C35D6A23E01922BCA4ADB25E2EC3DE22FBB';

    console.log('sig hex: \n', sigHex);
    console.log('pub key hex: ', pubKeyHex);
    const byteArray = [0x01, 0x02, 0x03, 0x04, 0x05];
    const uint8Array = new Uint8Array(byteArray);
    const verified = await dilithium.open(
        uint8Array,
        fromHexString(pubKeyHex),
    );
    console.log('verified: ', toHexString(verified) === messageHex);
})();
